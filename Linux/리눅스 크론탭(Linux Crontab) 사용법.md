# 리눅스 크론탭(Linux Crontab) 사용법

### 1. 크론탭 기본 (crontab basic)

크론탭 작성

```bash
$ crontab -e
```

크론탭 확인

```bash
$ crontab -l
```

크론탭 삭제

```bash
$ crontab -r
```

### 2. 주기 결정

```
*　　　　　　*　　　　　　*　　　　　　*　　　　　　*
분(0-59)　　시간(0-23)　　일(1-31)　　월(1-12)　　　요일(0-7)
```

각 별 위치에 따라 주기를 다르게 설정 할 수 있습니다. 순서대로 분-시간-일-월-요일 순입니다. 그리고 괄호 안의 숫자 범위 내로 별 대신 입력 할 수 있습니다.

요일에서 0과 7은 일요일입니다. 1부터 월요일이고 6이 토요일입니다.

### 3. 주기별 예제

#### 3.1. 매분 실행

```bash
# 매분 test.sh 실행
* * * * * /home/script/test.sh
```

#### 3.2. 특정 시간 실행

```bash
# 매주 금요일 오전 5시 45분에 test.sh 를 실행
45 5 * * 5 /home/script/test.sh
```

#### 3.3. 반복 실행

```bash
# 매일 매시간 0분, 20분, 40분에 test.sh 를 실행
0,20,40 * * * * /home/script/test.sh
```

#### 3.4. 범위 실행

```bash
# 매일 1시 0분부터 30분까지 매분 tesh.sh 를 실행
0-30 1 * * * /home/script/test.sh
```

#### 3.5. 간격 실행

```bash
# 매 10분마다 test.sh 를 실행
*/10 * * * * /home/script/test.sh
```

#### 3.6. 조금 복잡하게 실행

```bash
# 5일에서 6일까지 2시,3시,4시에 매 10분마다 test.sh 를 실행
*/10 2,3,4 5-6 * * /home/script/test.sh
```

- 주기 입력 방법엔 \* , - / 을 이용하는 방법이 있습니다.

### 4. 크론 사용 팁

#### 4.1. 한 줄에 하나의 명령만 씁시다.

```bash
# 잘못된 예
* * * 5 5
/home/script/test.sh
# 잘된 예
* * * 5 5 /home/script/test.sh
```

#### 4.2. 주석을 달아봅시다.

```bash
# 주석 #
#--------------------#
# 이것은 주석입니다. #
#--------------------#
```

### 5. 크론 로깅 (cron logging)

크론탭을 사용해서 정기적으로 작업을 처리하는 것은 좋은데, 해당 처리 내역에 대해 로그를 남기고 싶을 때가 있을겁니다. 그럴때 다음처럼 한번 써봅시다.

```bash
* * * * * /home/script/test.sh > /home/script/test.sh.log 2>&1
```

위처럼 작성하면 매분마다 test.sh.log 파일이 갱신 되어 작업 내용이 어떻게 처리 되었는지 알 수 있습니다. 만약 2>&1 을 제거하면 쉘스크립트에서 표준 출력 내용만 나옵니다.

그런데, 이게 너무 자주 실행 되고 또한 지속적으로 로깅이 되야 해서 로그를 계속 남겨둬야 한다면 다음처럼 입력합니다.

```bash
* * * * * /home/script/test.sh >> /home/script/test.sh.log 2>&1
```

그러면 계속 로그가 누적이 되는 것을 확인 할 수 있을겁니다. 대신 로그가 과도하게 쌓이면 리눅스 퍼포먼스에 영향을 주므로 가끔씩 비워주거나 파일을 새로 만들어주어야 합니다.

반대로 로그는 필요 없는 크론을 위해선 다음처럼 입력합니다.

```bash
* * * * * /home/script/test.sh > /dev/null 2>&1
```

### 6. 크론 오류 무시

실패해도 크론 작업이 오류를 보고하지 않도록 설정

```bash
... || true
```
